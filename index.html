<!DOCTYPE html>
<html lang="en">
<head>
    <title>Seattle Home Prices</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--add required stylesheets-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!--leaflet css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">


    <!--add favicon for the web page-->
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">

    <!--Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Cairo" rel="stylesheet">


    <link rel="stylesheet" type="text/css" href="css/storymap.2.5.css">
    <!--add required libraries-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.js"></script>
    <!--jquery-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>

    <!--boostrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!--leaflet.ajax for asynchronously adding geojson data-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>

    <!--mini globle map-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <!-- <script src="../../js/globeminimap.js"></script> -->

    <!--story map plugin-->
    <script src="js/storymap.2.5.js"></script>

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      //homeprice curve chart
      google.charts.load("visualization", "1", {'packages':['corechart']});
      google.charts.setOnLoadCallback(priceChart);

      function priceChart() {
        var options = {
            title: 'Seattle Home Market Overview 2011 - 2020'
        };

        var data = google.visualization.arrayToDataTable([
          ['Month', 'Prices in $'],
          ['Jun 2011', 382000],
          ['Jun 2012', 384000],
          ['Jun 2013', 441000],
          ['Jun 2014', 476000],
          ['Jun 2015', 521000],
          ['Jun 2016', 604000],
          ['Jun 2017', 688000],
          ['Jun 2018', 787000],
          ['Jun 2019', 741000],
          ['Mar 2020', 755000],
        ]);

        var chart = new google.visualization.LineChart(document.getElementById('curve_chart_div'));
        chart.draw(data, options);
      }
    </script>
</head>

<body>
  <nav class="navbar navbar-dark bg-dark fixed-top navbar-expand-md">
      <div class="container">
          <a class="navbar-brand" href="#">
            <img src="img/favicon.ico" class="align-top" height="30px" align="left">
          </a>
          <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> ☰
          </button>
          <div id="navbar" class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                  <li class="active">
                      <a href="#" class="nav-link">Home</a>
                  </li>
                  <li>
                      <a href="#price" class="nav-link">Market</a>
                  </li>
                  <li>
                      <a href="#train" class="nav-link">Light Rail</a>
                  </li>
                  <li>
                      <a href="#mha" class="nav-link">MHA</a>
                  </li>
              </ul>
              <ul class="nav navbar-nav ml-auto">
                      <a href="https://github.com/chongzhiyang/storymap" class="nav-link"><i class="fab fa-github fa-lg"></i></a>
                  <li>
                      <a class="nav-link"><i class="fas fa-info-circle fa-lg" style="top:60px" data-toggle="modal" data-target="#info-modal"></i></a>
                  </li>
              </ul>
          </div>
          <!--/.nav-collapse -->
      </div>
  </nav>

<div id="storymap" class="container-fluid">
    <div class="row">
        <div class="col-sm-6 col-md-4 storymap-story">
            <section data-scene="overview" data-background="assets/seattle.mp4">
                <div class="fullscreen text-center">

                    <h1 class="display-4 d-flex justify-content-center" style="color: white">Seattle Home Prices</h1>

                    <!-- <small class="d-flex justify-content-center" style="color: white">This story map
                        talks about the changes of Seattle home market.
                    </small> -->
                </div>
            </section>

            <section id="price" data-scene="homeMarket">
                <h2>Seattle Home Market</h2>
                <div id="chart_wrap">
                <div id="curve_chart_div"></div></div>
                <p>Over the past 10 years, the housing prices in Seattle had increased rapidly by a huge
                  amount, in 2015, the home prices rose 10.5 percent, reached its highest peak, 508,000
                  dollars, compared to the previous year, and the growth of home prices is twice the
                  rate of inflation. With this rate of growth in housing prices, homebuyers
                  need more budgets for buying a house, or they lose their hopes for a dream home. Also,
                  some people are suffering from high rent for their house, which affects their life quality. </p>
            </section>

            <section id="train" data-scene="train">
                <h2>The expansion of light rail transit</h2>
                <p>The expansion of light rail transit is one of the factors that contributed to the rapid growth of housing prices.
                  Link Light Rail was proposed and approved in 1996, a light rail system managed by Sound Transit in response to population
                  growth and urban development. The announcement of plans for new transit lines will bring in the attention of homebuyers
                  and developers because housing and land-value will increase significantly as land development increases before new lines open.
                  After the announcement of new lines, the housing prices had increased by 21.3 percent year-on-year, and 3.8 percent month-to-month in Wuhan, China
                  in September 2016. When the expansion of light rail is completed, there will be 10 new light rail stations in Bellevue, Mercer
                  Island, Redmond, and Seattle. Cities are connected by light rail route, people will spend less time to
                  travel around these cities compared to buses, and more options for traveling plans, which improve the residents’ convenience.
                  Even though, a light station in a neighborhood, housing prices and distance to the station have an inverse relationship, as the
                  distance to the metro station decreases, the average home prices will increase </p>
            </section>

            <section id="mha"data-scene="mha">
                <h2>Mandatory Housing Affordability (MHA)</h2>
                <img src="img/MHA.jpg" class="img-responsive img-thumbnail" alt="responsive image"
                     alt-text="MHA">
                <p>Mandatory Housing Affordability (MHA) is a policy that proposed and approved by the Seattle City Council, to create more
                  affordable housing for low-income families. This policy allows developers to build taller buildings and denser neighborhoods in
                  certain areas, but for each new building about 5% to 7% of homes are affordable housing for low-income families, with this new
                  policy, there will be 6,000 new affordable homes in 2025. Moreover, MHA will replace old buildings with
                  new and cheaper homes, and many developers, nonprofit organizations, and unions support MHA, they believe MHA helps the city become
                  more urban and livable. As the population of Seattle increases, MHA brings more housings to the home market,
                  and affordable housings as well, which is beneficial for everyone that lives in Seattle. </p>
            </section>

            <section data-scene="end" data-background="assets/end.mp4">
                <div class="fullscreen text-center">
                    <h1 class="display-4 d-flex justify-content-center">Thanks for watching!!!</h1>
                    <!-- <small class="d-flex justify-content-center" style="color: rgba(255,255,255,0.95)">Your
                        Acknowledgement goes here
                    </small> -->
                </div>
            </section>

        </div>
        <!--map div-->
        <div class="col-sm-6 col-md-8 storymap-map"></div>
    </div>


    <!--the info page-->
    <div class="modal fade" id="info-modal" role="dialog">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">About</h4>
                </div>
                <div class="modal-body">
                    <p>This is a web map about Seattle home prices. It is the final project of GEOGRAPHY 458: Advanced
                      Digital Geographies by University of Washington. The story map library is derived from the
                        storymap plugin for leaflet at <a>http://atlefren.github.io/storymap/</a>, and its functionality
                        relies on both leaflet and Boostrap. Also, the curve chart function relies on Google charts.</p>
                    <p><b>storymap.js</b> | Released Date: 02/20/2017 | Version: 2.5 | MIT License </p>
                    <p><b>Author: Chongzhi Yang</b> | Department of Geography | University of Washington
                    </p>
                    <p>The chart data was collected from <a href="https://www.zillow.com/seattle-wa/home-values/was">Zillow</a>.</p>
                    <p>Housing information was collected from Redfin.
                    <p>The information about MHA was collected from Wikipedia, <a href="https://www.seattle.gov/hala/about/mandatory-housing-affordability-(mha)">Seattle.gov</a>,
                      and <a href="http://data-seattlecitygis.opendata.arcgis.com/datasets/mandatory-housing-affordability-mha-zones?geometry=-122.664%2C47.575%2C-122.011%2C47.656">Seattle GeoData</a>.</p>
                    <p>The information about Link light rail was collected from Wikipedia.</p>
                    <p>Tu, J., (2015). Seattle-area home-price gains race ahead of national rate. The Seattle Times.</p>
                    <p>Tan, R., He, Q., Zhou, K., Xie, P., (2019). The effect of new metro stations on local land use and housing prices:
                      The case of Wuhan, China. Journal of Transport Geography 79, 102488.</p>
                    <p>The <a href="https://www.youtube.com/watch?v=2sInnVwH_fM">background video</a> on the front page
                        was clipped from Youtube. </p>
                    <p>This story map uses geospatial data from mapbox, Google Earth Engine, ESRI Map, Open Street Maps.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- main javascript -->
<script type="text/javascript">


    // Create Legend Contents in html format
    // var county_legend = '<i style="background: orange; opacity: 0.5"></i><p><b>Counties</b></p>';
    // var forest_legend = '<i style="background: green; opacity: 0.5"></i><p><b>Forest</b></p>';

    // For each layer, the first variable is the layer, the second is the legend. The layer variable can be any kinds of layers that leaflet.js supports.
    // var layers = {
    //      layer1: {layer: layer1, legend: legend1},
    //      layer2: {layer: layer2, legend: legend2}
    //      ...
    // }

    var layers = {
        ESRI: {layer: L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}')},

        homePrice: {
            layer: L.geoJson.ajax('assets/homeprice.geojson', {
              onEachFeature: function (feature, layer) {
                  layer.bindPopup('<h6>Price: $'+feature.properties.PRICE+'<br>Square FT: '+feature.properties.SQUAREFEET+'<br>$ per square ft: $'+feature.properties.MONEYPERSQUAREFEET+
                  '<br>Zip Code: '+feature.properties.ZIPCODE+'<br>Bedrooms: '+feature.properties.BEDS+'<br>Bathrooms: '+feature.properties.BATHS+'<br>Residential Type: '+feature.properties.TYPE+'</h6>');
              },
            }),
        },

        train: {
            layer: L.geoJson.ajax('assets/train.geojson', {
              onEachFeature: function (feature, layer) {
                  layer.bindPopup('<h6>'+feature.properties.name+'</h6>');
              },
            }),
        },

        mha: {
            layer: L.geoJson.ajax('assets/MHA.geojson', {
              onEachFeature: function (feature, layer) {
                  layer.bindPopup('<h6>MHA apply: '+feature.properties.MHA+'<br>Zoning description: '+feature.properties.ZONING_DESC+
                  '<br>Effective date: '+feature.properties.EFFECTIVE+'</h6>');
              },
            }),
        },

        cartodb_light: {layer: L.tileLayer('http://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png')}
    };

    var scenes = {
        overview: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'Cover Page', layers: []},
        homeMarket: {lat: 47.607168, lng: -122.392983, zoom: 12.1, name: 'homeMarket', layers: [layers.ESRI, layers.homePrice]},
        train: {lat: 47.5588087, lng: -122.3656657, zoom: 12, name: 'train', layers: [layers.train]},
        mha: {lat: 47.607168, lng: -122.392983, zoom: 12.5, name: 'mha', layers: [layers.mha]},
        end: {lat: 44.0000000, lng: -123.5000000, zoom: 7, name: 'The End'}
    };

    $('#storymap').storymap({
        scenes: scenes,
        baselayer: layers.cartodb_light,
        legend: true, // if you do not want a legend feature, you can simply not define the createLegend function.
        credits: "",
        loader: true,
        scalebar: false,
        fly: true,
        navwidget: false,

        createMap: function () {
            // create a map in the "map" div, set the view to a given place and zoom
            var map = L.map($(".storymap-map")[0], {
                zoomControl: false, scrollWheelZoom: false, fadeAnimation: true,
                zoomAnimation: true
            }).setView([44, -120], 7);

            //add an miniglobe
            // new L.Control.GlobeMiniMap({
          //      marker: 'red',
            //    position: 'bottomright'
            //}).addTo(map);


            return map;
        }
    });
</script>
</body>
</html>
